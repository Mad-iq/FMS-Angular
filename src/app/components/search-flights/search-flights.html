<app-navbar></app-navbar>
<div class="page-container">
  <section class="searcher-section">
    <div class="searcher-content">
      <h1>Book Domestic and International Flight Tickets</h1>
      <p>Search and compare Flights from hundreds of Airlines</p>
     
      <div class="search-card">
        <div class="search-tabs">
          <button type="button" class="tab" [class.active]="!searchForm.roundTrip" (click)="searchForm.roundTrip = false">One Way</button>
          <button type="button" class="tab" [class.active]="searchForm.roundTrip" (click)="searchForm.roundTrip = true">Round Trip</button>
         </div>
       
        <form class="search-form" (ngSubmit)="searchFlights()">
          <div class="input-row">
            <div class="input-group">
              <label>From (City Code)</label>
              <input type="text" [(ngModel)]="searchForm.source" name="source" placeholder="e.g DELHI, MUMBAI" required>
            </div>
            <div class="input-group">
              <label>To (City Code)</label>
              <input type="text" [(ngModel)]="searchForm.destination" name="destination" placeholder="e.g DELHI" required>
             </div>
          </div>
          <div class="input-row">
            <div class="input-group">
              <label>Departure Date</label>
              <input type="date" [(ngModel)]="searchForm.departureDate" name="departureDate" [min]="today" required>
            </div>
            <div class="input-group" *ngIf="searchForm.roundTrip">
              <label>Return Date</label>
              <input type="date" [(ngModel)]="searchForm.returnDate" name="returnDate">
             </div>
            <div class="input-group">
              <label>Passengers</label>
              <input type="number" [(ngModel)]="searchForm.numberOfPassengers" name="numberOfPassengers" min="1" max="50" required>
            </div>
          </div>
          <div class="error-message" *ngIf="errorMessage && !searched">
            {{ errorMessage }}
          </div>
          <button type="submit" class="btn-search">Search Flights</button>
        </form>
       </div>
    </div>
  </section>
  
  <section class="results-section" *ngIf="searched">
    <div class="results-container">
      <div class="results-header">
        <h2>Available Flights ({{flights.length}} found)</h2>
      </div>
       <div class="loading" *ngIf="isLoading">
        <p>Searching for flights...</p>
       </div>
      <div class="no-results" *ngIf="!isLoading && errorMessage && flights.length === 0">
        <h3>{{ errorMessage }}</h3>
        <p>Please try different search criteria</p>
      </div>
      <div class="flight-list" *ngIf="!isLoading && flights.length > 0">
        <div class="flight-card" *ngFor="let flight of flights; let i = index">
          <div class="flight-header">
            <div class="airline-info">
              <div>
                <h4>{{ flight.airline}}</h4>
                <span class="flight-number">{{flight.flightId}}</span>
              </div>
            </div>
            <div class="price-info">
              <span class="price">₹{{ flight.price}}</span>
              <span class="price-label">per person</span>
            </div>
           </div>
          <div class="flight-details">
            <div class="flight-time">
              <div class="time-block">
                <span class="time">{{ formatTime(flight.dateTime) }}</span>
                <span class="airport">{{ searchForm.source }}</span>
                <span class="city">{{ formatDate(flight.dateTime) }}</span>
              </div>
             
              <div class="flight-duration">
                <span class="duration">Direct Flight</span>
                <div class="duration-line">
                  <div class="plane-icon">✈</div>
                </div>
                <span class="stops">Non-stop</span>
              </div>
              <div class="time-block">
                <span class="time">Arrives</span>
                <span class="airport">{{ searchForm.destination }}</span>
                <span class="city">{{ formatDate(flight.dateTime) }}</span>
              </div>
            </div>
          </div>
          <div class="flight-footer">
            <div class="amenities">
              <span class="amenity">{{flight.availableSeats|| 0 }} seats left</span>
            </div>
            <button class="btn-book" (click)="goToBooking(flight.flightId)">Select Flight</button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
